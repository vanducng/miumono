# Documentation deployment workflow
# Mintlify docs are deployed via Mintlify GitHub App
# This workflow validates docs on PR and triggers deployment on push to main

name: Docs

on:
  push:
    branches: [main]
    paths:
      - 'docs/**'
  pull_request:
    branches: [main]
    paths:
      - 'docs/**'
  workflow_dispatch:

jobs:
  validate:
    name: Validate Documentation
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Check docs.json exists
        run: |
          if [ ! -f docs/docs.json ]; then
            echo "Error: docs/docs.json not found"
            exit 1
          fi
          echo "docs.json found"

      - name: Validate docs.json syntax
        run: |
          python3 -c "import json; json.load(open('docs/docs.json'))"
          echo "docs.json is valid JSON"

      - name: Check required MDX files exist
        run: |
          # Check navigation entries exist
          for file in \
            "docs/getting-started/introduction.mdx" \
            "docs/getting-started/quickstart.mdx" \
            "docs/getting-started/installation.mdx" \
            "docs/core-concepts/architecture.mdx" \
            "docs/core-concepts/packages.mdx" \
            "docs/guides/code-standards.mdx" \
            "docs/guides/deployment.mdx" \
            "docs/guides/release-management.mdx" \
            "docs/contributing/roadmap.mdx" \
            "docs/contributing/codebase-summary.mdx" \
            "docs/api-reference/overview.mdx"
          do
            if [ ! -f "$file" ]; then
              echo "Warning: $file not found"
            else
              echo "Found: $file"
            fi
          done

      - name: Check assets exist
        run: |
          for file in \
            "docs/favicon.svg" \
            "docs/logo/logo-light.svg" \
            "docs/logo/logo-dark.svg"
          do
            if [ ! -f "$file" ]; then
              echo "Warning: $file not found"
            else
              echo "Found: $file"
            fi
          done

      - name: Summary
        run: |
          echo "Documentation validation complete"
          echo "Mintlify will auto-deploy via GitHub App on push to main"
